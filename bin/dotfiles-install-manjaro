#!/bin/sh

sudo pacman -Syu

# aur yaourt installer
sudo pacman -S --noconfirm yaourt

# teminal tools
sudo pacman -S --noconfirm \
  git bash-completion tk \
  tmux fish exa \
  p7zip zip unzip \
  the_silver_searcher mc \
  python-pip python2-pip \
  python-neovim python2-neovim \
  neovim ctags jq sqlite \
  weechat task youtube-dl \
  lib32-gconf \
  tree feh xclip kcolorchooser

git config --global user.name "Hugues Dubois"
git config --global user.email "hugdubois@gmail.com"
sudo git config --global user.name "Hugues Dubois"
sudo git config --global user.email "hugdubois@gmail.com"

# PHP/composer
sudo pacman -S --noconfirm \
  php php-fpm composer php-intl php-gd

# mpd / ncmpcpp
sudo pacman -S --noconfirm \
  mpd ncmpcpp

# virtualbox
sudo pacman -S --noconfirm \
  virtualbox \
  linux419-virtualbox-host-modules
sudo modprobe vboxdrv
sudo gpasswd -a hug vboxusers

# docker
sudo pacman -S --noconfirm \
  docker docker-compose

sudo groupadd docker
sudo usermod -aG docker hug

# nginx
sudo systemctl stop nginx
sudo pacman -S --noconfirm nginx


############## DATABASES ##############

# databases mariadb/postgresql
sudo systemctl stop mysqld
sudo pacman -S --noconfirm \
  mariadb mariadb-clients
sudo /usr/bin/mysql_install_db --user=mysql --basedir=/usr --datadir=/var/lib/mysql
sudo systemctl start mysqld
sudo mysql_secure_installation
sudo systemctl enable mysqld
# sudo mysql -A -u root -p

sudo systemctl stop postgresql
sudo pacman -S --noconfirm \
  postgresql postgis postgresql-libs postgresql-old-upgrade
sudo -u postgres initdb --locale en_US.UTF-8 -D '/var/lib/postgres/data'
sudo systemctl start postgresql
sudo systemctl enable postgresql
sudo createuser -U postgres -s hug
# to connect to postgresql
# psql -h localhost -U ... -p ... -d ...

# retro gamming/games
sudo pacman -S --noconfirm \
  retroarch retroarch-assets-xmb


sudo pacman -S --noconfirm etckeeper
sudo etckeeper init
sudo etckeeper commit -m "First commit"
sudo systemctl start etckeeper.timer
sudo systemctl enable etckeeper.timer

sudo pacman -S --noconfirm libcurl-gnutls lib32-libcurl-gnutls

sudo pacman -S --noconfirm crystal shards

############## SOME EXTRA EXTENSIONS ##############

# git flow
yaourt -S --noconfirm gitflow-avh-git


# visual studio code
yaourt -S --noconfirm visual-studio-code-bin

# mongodb
yaourt -S --noconfirm mongodb-bin


# php extensions
yaourt -S --noconfirm php-redis php-mongodb php-amqp

# wrk benchmark tool
yaourt -S --noconfirm wrk

####################
# install dotfiles #
####################
if [ ! -d "$HOME/go/src/github.com/hugdubois/dotfiles" ]; then
  mkdir -p $HOME/go/src/github.com/hugdubois/
  git clone https://raw.githubusercontent.com/hugdubois/dotfiles $HOME/go/src/github.com/hugdubois/dotfiles
fi;
DOTFILES_PATH=$HOME/go/src/github.com/hugdubois/dotfiles
cd $DOTFILES_PATH
#$DOTFILES_PATH/bin/dotfiles-install
$DOTFILES_PATH/bin/installers/core.sh
$DOTFILES_PATH/bin/installers/bash.sh
$DOTFILES_PATH/bin/installers/tmux.sh
$DOTFILES_PATH/bin/installers/ctags.sh
$DOTFILES_PATH/bin/installers/fish.sh
$DOTFILES_PATH/bin/installers/go.sh
$DOTFILES_PATH/bin/installers/mc.sh
$DOTFILES_PATH/bin/installers/mpd.sh
$DOTFILES_PATH/bin/installers/nvim.sh
$DOTFILES_PATH/bin/installers/nvm.sh
$DOTFILES_PATH/bin/installers/ranger.sh
#$DOTFILES_PATH/bin/installers/rustup.sh
$DOTFILES_PATH/bin/installers/weechat.sh
$DOTFILES_PATH/bin/installers/zsh.sh
